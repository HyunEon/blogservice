{% load mptt_tags %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/settings/categorysettings.css' %}">

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/nestable2/1.6.0/jquery.nestable.min.js"></script>
{% endblock %}
{% block content %}

{% if categories %}
{% csrf_token %}
<div class="category-settings-container">
  <div class="category-tree">
    <button id="CreateCategoryBtn" class="CreateCategoryBtn">ï¼‹ ìƒˆ ì¹´í…Œê³ ë¦¬</button>
    <!-- ëª¨ë‹¬ -->
    <div id="categoryModal" class="modal" style="display:none;">
    <form id="categoryForm" class="CreateCategoryModal"method="POST" action="{% url 'createcategory' %}">
        {% csrf_token %}
        {% include "main/form_errors.html" %}
        {{ form.category_name.label_tag }}
        {{ form.category_name }}
        <button type="submit" class="modal-submit-btn">ì €ì¥</button>
        <button type="button" id="modalClose" class="modal-close-btn">ì·¨ì†Œ</button>
    </form>
    </div>
    <p class="category-short-guide">ğŸ‘‰ ì¹´í…Œê³ ë¦¬ëŠ” ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œë¥¼ ë³€ê²½í•˜ê³ , ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™í•´ í•˜ìœ„ ì¹´í…Œê³ ë¦¬ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    <div class="dd" id="category-nestable" data-reorder-url="{% url 'reordercategory' %}">
    <ol class="dd-list">
        {% recursetree categories %}
            <li class="dd-item" data-id="{{ node.category_id }}">
                <div class="dd-handle-wrapper">
                    <div class="dd-handle">{{ node.category_name }}</div>
                    <div class="dd-actions">
                            <button class="moreBtn" data-id="{{ node.category_id }}">â‹®</button>
                        </div>
                    </div>
                {% if not node.is_leaf_node %}
                    <ol class="dd-list">
                        {{ children }}
                    </ol>
                {% endif %}
            </li>
        {% endrecursetree %}
    </ol>
</div>
</div>
 <div class="category-detail" id="category-detail">
    <div class="category-detail-subject">
        <h3>ì¹´í…Œê³ ë¦¬ ì •ë³´</h3>
        <button id="categoryEditBoxClostButton" class="category-editbox-close-btn">âœ•</button>
    </div>
    <div id="categoryEditBox">
        {% csrf_token %}
        <label>ì´ë¦„</label>
        <input type="text" name="name" id="categoryNameInput" class="form-control" placeholder="ì„ íƒëœ ì¹´í…Œê³ ë¦¬ ì—†ìŒ" disabled>
        <div class="dd-handle-action-btn">
            <button id="saveCategoryBtn" class="editcategorybutton">ì €ì¥</button>
            <form id="deleteCategoryForm" class="form-delete-category" method="POST">
                {% csrf_token %}
                <button type="submit" id="deleteCategoryBtn">ì‚­ì œ</button>
            </form>
        </div>
    </div>
  </div>
{% endif %}
{% endblock %}

{% block extra_scripts %}
<!-- ìŠ¤í¬ë¦½íŠ¸ -->
<script src="{% static 'js/categorysettings.js' %}"></script>
{% endblock %}